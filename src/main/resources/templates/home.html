<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube SEO Tag Generator</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: { 50: "#eff6ff", 500: "#2563eb", 600: "#1d4ed8", 700: "#1d4ed8" },
                        accent: "#22c55e"
                    }
                }
            }
        }
    </script>

    <style>
        .main-title {
            background: linear-gradient(90deg, #2563eb, #22c55e);
            -webkit-background-clip: text;
            color: transparent;
        }
        .gradient-header {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.08), rgba(34, 197, 94, 0.08));
            border: 1px dashed #e2e8f0;
        }
        .tag {
            background: rgba(34, 197, 94, 0.15);
            border: 1px solid #e2e8f0;
            transition: 0.15s;
        }
        .tag:hover {
            background: rgba(34, 197, 94, 0.22);
            transform: translateY(-1px);
        }
        .error {
            background: rgba(239, 68, 68, 0.12);
            color: #ef4444;
            border-left: 4px solid #ef4444;
        }
        .success {
            background: rgba(16, 185, 129, 0.12);
            color: #10b981;
            border-left: 4px solid #10b981;
        }
        .dark .gradient-header {
            border-color: #334155;
        }
        .dark .tag {
            border-color: #334155;
        }
    </style>
</head>

<body class="bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100 min-h-screen">

<div th:replace="~{fragments/navbar :: navbar}" th:with="activePage='home'"></div>

<div class="container mx-auto px-4 max-w-2xl mt-12 pb-12">

    <div class="text-center mb-8">
        <h1 class="main-title text-4xl md:text-5xl font-extrabold mb-4">YouTube SEO Tag Generator</h1>

        <div class="gradient-header p-4 rounded-xl mt-6">
            <p class="text-slate-600 dark:text-slate-400 text-lg">Enter a YouTube video title to find SEO tags.</p>
        </div>
    </div>

    <!-- Form -->
    <div class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-lg p-6 rounded-2xl mb-8">
        <form th:action="@{/youtube/search}" method="post">
            <label class="block mb-2 text-sm">YouTube Video Title</label>
            <input type="text" name="videoTitle" required
                   class="w-full rounded-lg px-4 py-3 border dark:border-slate-600 bg-white dark:bg-slate-700 mb-4">

            <button type="submit"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg shadow-lg">
                + Generate SEO Tags
            </button>
        </form>
    </div>

    <!-- Error -->
    <div th:if="${error}" class="error p-4 rounded-lg mb-4" th:text="${error}"></div>

    <!-- Primary Video Tags -->
    <div th:if="${primaryVideo != null}"
         class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-lg p-6 rounded-2xl mb-8">

        <div class="flex justify-between items-center mb-4">
            <div class="font-bold">
                <i class="bi bi-star-fill text-blue-500"></i> Primary Video Tags
            </div>

            <!-- FIXED BUTTON -->
            <button type="button"
                    th:data-tags="${primaryVideoTagsAsString}"
                    onclick="copyTags(this.dataset.tags)"
                    class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm flex items-center gap-2">
                <i class="bi bi-clipboard2-check"></i> Copy Tags
            </button>
        </div>

        <div class="mb-4" th:text="${primaryVideo.title}"></div>
        <div class="mb-4" th:text="${primaryVideo.channelTitle}"></div>

        <div>
                <span th:each="tag : ${primaryVideo.tags}"
                      class="tag inline-flex items-center px-3 py-2 rounded-full mr-2 mb-2 text-sm">
                    <i class="bi bi-hash"></i> <span th:text="${tag}"></span>
                </span>
        </div>
    </div>

    <!-- Related Videos Tags -->
    <div th:if="${relatedVideos != null}"
         class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-lg p-6 rounded-2xl mb-8">

        <div class="flex justify-between items-center mb-4">
            <div class="font-bold">
                <i class="bi bi-collection text-blue-500"></i> Related Videos Tags
            </div>

            <!-- FIXED BUTTON -->
            <button type="button"
                    th:data-tags="${allTagsAsString}"
                    onclick="copyTags(this.dataset.tags)"
                    class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm flex items-center gap-2">
                <i class="bi bi-clipboard2"></i> Copy All
            </button>
        </div>

        <div th:each="video : ${relatedVideos}" class="mb-6">

            <div class="font-semibold mb-2">
                <i class="bi bi-play-btn text-blue-500"></i>
                <span th:text="${video.title}"></span>
            </div>

            <div>
                <span th:if="${#lists.isEmpty(video.tags)}" class="italic text-slate-500">No tags found</span>

                <span th:each="tag : ${video.tags}"
                      class="tag inline-flex items-center px-3 py-2 rounded-full mr-2 mb-2 text-sm">
                        <i class="bi bi-tag"></i> <span th:text="${tag}"></span>
                    </span>
            </div>
        </div>
    </div>

    <div id="copySuccess" class="success hidden p-4 rounded-lg mb-4">Tags copied!</div>

</div>

<script>
    function copyTags(tags) {
        navigator.clipboard.writeText(tags)
            .then(() => {
                const box = document.getElementById("copySuccess");
                box.classList.remove("hidden");
                setTimeout(() => box.classList.add("hidden"), 2000);
            });
    }
</script>

</body>
</html>
